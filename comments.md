At WillKG's suggestion, to support working on this offline, I'm using a branch and embedding comments directly in the code, which can be reformatted later.
